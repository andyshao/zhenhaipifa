
<div class="box">
	<div class="box-header with-border">
		<h3 id="box-title" class="box-title"></h3>
		<span class="form-group mr15"></span><a href="./add.html" data-toggle="modal" class="btn btn-success pull-right">添加</a>
	</div>
	<div class="box-body">
		<div class="table-responsive">

			<form id="form_list" runat="server">
				<table id="GridView1" cellspacing="0" rules="all" border="1" style="border-collapse:collapse;" class="table table-bordered table-hover">
					<tr>
						<th scope="col">结构名称</th>
						<th scope="col">id</th>
						<th scope="col">市场</th>
						<th scope="col">父</th>
						<th scope="col">排序</th>
						<th scope="col" style="width:5%;">&nbsp;</th>
						<th scope="col" style="width:5%;">删除</th>
					</tr>
					<tbody>
						<tr data-tt-id="{#Id}" data-tt-parent-id="{#Parent_id}">
							<td>{#String(Title).htmlencode()}</td>
							<td>{#Id}</td>
							<td>[{#Market_id}]{#Obj_market.Title}</td>
							<td>{#Parent_id}</td>
							<td>{#Sort}</td>
							<td><a href="add.html?Id={#Id}">修改</a></td>
							<td><input id="id" name="id" type="checkbox" value="{#Id}" /></td>
						</tr>
					</tbody>
				</table>
			</form>

		</div>
	</div>
</div>

<div>
	<font color="red">*</font> 删除父项时，请先删除其所有子项。
	<a id="btn_delete_sel" href="#" class="btn btn-danger pull-right">删除选中项</a>
</div>

<script type="text/javascript">
(function() {
	$.getJSON('/api/Markettype/', { limit: 2000 }, function(rt) {
		for (var a = 0; a < rt.data.items_market.length; a++) rt.data.items[a].Obj_market = rt.data.items_market[a];
		rt.items2 = yieldTreeArray(rt.data.items, null, 'Id', 'Parent_id');
		var tpl = $('#GridView1 tbody:last').html();
		$('#GridView1 tbody:last').html(yieldTreeTable(rt.items2, tpl));
		$('table#GridView1').treetable({ expandable: true });
		$('table#GridView1').treetable('expandAll');
		top.mainViewInit();
	});
})();
</script>